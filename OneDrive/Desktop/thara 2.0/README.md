# Purple 2.0 - AI-Powered Voice Assistant

[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)
[![TensorFlow](https://img.shields.io/badge/TensorFlow-2.x-orange.svg)](https://www.tensorflow.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

**Purple 2.0** is an intelligent voice-controlled personal assistant built with Python that can understand voice commands, control applications, manage system resources, search the web, and engage in conversational interactions using a custom-trained LLM model.

## üåü Features

### üé§ Voice Recognition
- **Advanced Speech Recognition**: Uses Google Speech Recognition API with Indian English (en-in) support
- **Ambient Noise Adjustment**: Automatically adjusts for background noise
- **Extended Listening**: Supports up to 60-second voice input with 45-second phrase time limit
- **Dual Input Modes**: Voice commands or text input (switchable at runtime)
- **Microphone Detection**: Automatically detects and lists available microphones

### üñ•Ô∏è Application Management
- **Open Applications**: Calculator, Notepad, Paint, MS Word, MS Excel
- **Close Applications**: Intelligent process termination using multiple methods (taskkill, psutil, PowerShell)
- **Windows Store App Support**: Special handling for Calculator (Windows 10/11 UWP apps)
- **Process Verification**: Confirms successful closure of applications

### üåê Browser & Web Control
- **Social Media Access**: Quick access to Facebook, WhatsApp, Instagram, YouTube, ChatGPT
- **Google Search Integration**: Intelligent search term extraction and web search
- **Browser Control**: Open/close Google, Microsoft Edge
- **Tab Management**: Close social media tabs using keyboard shortcuts or process termination
- **Auto-Exit**: Automatically exits program after opening search results (as configured)

### üîä System Controls
- **Volume Management**: Increase, decrease, or mute system volume
- **System Monitoring**: 
  - CPU usage monitoring with status alerts
  - Memory (RAM) usage tracking
  - Disk space monitoring (C: drive)
  - Network I/O statistics
  - Battery status (for laptops)
  - Temperature sensors (if available)

### üìÖ Schedule Management
- **Daily Schedule**: Personalized weekly schedule with day-specific activities
- **Time-based Greetings**: Context-aware greetings (Good Morning/Afternoon/Evening)
- **Day Recognition**: Automatic day-of-week detection

### ü§ñ AI Chatbot Integration
- **Custom LLM Model**: TensorFlow/Keras-based neural network for intent recognition
- **Intent Classification**: Identifies user intent from natural language
- **Contextual Responses**: Provides appropriate responses based on detected intent
- **Smart Filtering**: Filters out system commands and file paths to prevent unwanted responses
- **Confidence Threshold**: High-confidence requirement (60%+) for accurate responses

### üîç Intelligent Search
- **Natural Language Processing**: Extracts search terms from conversational queries
- **Prefix Removal**: Automatically removes common query prefixes ("what is", "search for", etc.)
- **Web Scraping**: Attempts to extract information from Google search results
- **Multiple Browser Support**: Works with Chrome, Edge, Firefox, Brave, Opera

## üìã Requirements

### Python Packages
```bash
pip install pyttsx3
pip install speechrecognition
pip install pyautogui
pip install tensorflow
pip install numpy
pip install psutil
pip install requests
pip install beautifulsoup4
pip install scikit-learn
```

### System Requirements
- **OS**: Windows 10/11 (optimized for Windows)
- **Python**: 3.7 or higher
- **Microphone**: Working microphone for voice commands
- **Internet**: Required for speech recognition and web search
- **RAM**: Minimum 4GB (8GB+ recommended for TensorFlow)

### Model Files Required
- `chat_model.h5` - Trained TensorFlow model
- `tokenizer.pkl` - Text tokenizer
- `label_encoder.pkl` - Label encoder for intent classification
- `intents.json` - Intent patterns and responses

## üöÄ Installation

1. **Clone the repository:**
```bash
git clone https://github.com/Rajkumarceo/purple-2.0.git
cd purple-2.0
```

2. **Install dependencies:**
```bash
pip install -r requirements.txt
```

3. **Ensure model files are present:**
   - `chat_model.h5`
   - `tokenizer.pkl`
   - `label_encoder.pkl`
   - `intents.json`

   *(These files are generated by running `model_train.py`)*

4. **Run the assistant:**
```bash
python main.py
```

## üìñ Usage Guide

### Starting the Assistant

When you run `main.py`, the assistant will:
1. Load the LLM model and components
2. Greet you with a time-appropriate message
3. Ask for input mode preference (voice or text)
4. Begin listening for commands

### Voice Commands

#### Application Control
- **Open Apps**: "open calculator", "open notepad", "open paint", "open word", "open excel"
- **Close Apps**: "close calculator", "close notepad", "close paint", "close word", "close excel"

#### Social Media
- **Open**: "open facebook", "open whatsapp", "open instagram", "open youtube", "open chatgpt"
- **Close**: "close whatsapp", "close instagram", "close youtube", etc.

#### Web Search
- **Google Search**: "search for [query]", "what is [query]", "tell me about [query]"
- **Open Google**: "open google"
- **Open Edge**: "open edge" or "open microsoft edge"

#### System Control
- **Volume**: "volume up", "volume down", "volume mute"
- **System Info**: "system condition", "system status", "system information"

#### Schedule
- **View Schedule**: "schedule", "my schedule", "your timetable"

#### Exit
- **Quit Program**: "exit" or "quit"

### Text Input Mode

If voice recognition fails, you can:
- Type "text" to switch to text input mode
- Type "voice" to switch back to voice mode
- Enter commands directly via keyboard

## üèóÔ∏è Project Structure

```
purple-2.0/
‚îÇ
‚îú‚îÄ‚îÄ main.py                 # Main application file
‚îú‚îÄ‚îÄ model_train.py          # LLM model training script
‚îú‚îÄ‚îÄ model_test.py           # Model testing script
‚îú‚îÄ‚îÄ test_voice.py           # Voice recognition testing
‚îÇ
‚îú‚îÄ‚îÄ chat_model.h5           # Trained TensorFlow model (generated)
‚îú‚îÄ‚îÄ tokenizer.pkl           # Text tokenizer (generated)
‚îú‚îÄ‚îÄ label_encoder.pkl       # Label encoder (generated)
‚îú‚îÄ‚îÄ intents.json            # Intent patterns and responses
‚îÇ
‚îú‚îÄ‚îÄ README.md               # This file
‚îî‚îÄ‚îÄ LICENSE                 # License file
```

## üîß Configuration

### Customizing Schedule
Edit the `schedule()` function in `main.py` (lines 308-328) to customize your weekly schedule.

### Adjusting Voice Settings
Modify the `initialize_engine()` function (lines 38-46) to change:
- Voice selection (male/female)
- Speech rate
- Volume level

### LLM Confidence Threshold
Adjust the confidence threshold in `main.py` (line 986):
```python
if confidence > 0.6:  # Change this value (0.0 to 1.0)
```

### Speech Recognition Settings
Modify in `command()` function (lines 79-84):
- `energy_threshold`: Microphone sensitivity
- `pause_threshold`: Pause detection time
- `timeout`: Maximum listening time

## üß† Model Training

To train or retrain the LLM model:

1. **Prepare `intents.json`** with your intent patterns and responses
2. **Run training script:**
```bash
python model_train.py
```
3. **Test the model:**
```bash
python model_test.py
```

### intents.json Structure
```json
{
  "intents": [
    {
      "tag": "greeting",
      "patterns": ["hello", "hi", "hey"],
      "responses": ["Hello boss!", "Hi there!", "Hey!"]
    }
  ]
}
```

## üîç Technical Details

### Architecture
- **Voice Recognition**: Google Speech Recognition API
- **Text-to-Speech**: pyttsx3 (SAPI5 on Windows)
- **LLM**: TensorFlow/Keras neural network with:
  - Embedding layer
  - GlobalAveragePooling1D
  - Dense layers with ReLU activation
  - Softmax output for intent classification
- **Process Management**: psutil + subprocess (taskkill)
- **Web Scraping**: BeautifulSoup4 for search result parsing

### Command Processing Flow
1. Voice/Text input ‚Üí Speech Recognition
2. Command parsing ‚Üí Pattern matching
3. Intent classification (if no direct command match)
4. Action execution ‚Üí Feedback via TTS
5. Loop for next command

### Error Handling
- Graceful degradation if TensorFlow is unavailable
- Fallback methods for process termination
- Multiple browser detection methods
- Comprehensive error logging

## üêõ Troubleshooting

### Microphone Issues
- **No microphone detected**: Check Windows microphone permissions
- **Can't understand audio**: Speak more clearly, check microphone is not muted
- **Timeout errors**: Increase timeout in `command()` function

### Application Not Closing
- **Calculator**: May need PowerShell method (automatically attempted)
- **Browser tabs**: Ensure browser window is active when closing
- **Access denied**: Run Python with administrator privileges if needed

### LLM Not Responding
- **Model files missing**: Run `model_train.py` to generate required files
- **Low confidence**: Adjust confidence threshold or retrain model
- **Unwanted responses**: Check skip patterns in code (lines 958-962)

### TensorFlow Issues
- **Import errors**: Ensure TensorFlow is installed: `pip install tensorflow`
- **Version compatibility**: Code handles TensorFlow 2.10+ and older versions

## üìù Development Notes

### Adding New Commands
1. Add command detection in main loop (around line 859)
2. Create handler function if needed
3. Add to appropriate command category

### Extending LLM
1. Update `intents.json` with new patterns
2. Retrain model: `python model_train.py`
3. Test: `python model_test.py`

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üë§ Author

**Rajkumar**
- GitHub: [@Rajkumarceo](https://github.com/Rajkumarceo)
- Repository: [purple-2.0](https://github.com/Rajkumarceo/purple-2.0)

## üôè Acknowledgments

- Google Speech Recognition API for voice recognition
- TensorFlow team for the machine learning framework
- All open-source libraries used in this project
- Windows SAPI5 for text-to-speech functionality

## ‚ö†Ô∏è Disclaimer

This software is provided "as is" without warranty of any kind. The author is not responsible for any damage or data loss resulting from the use of this software. Always backup your data before using system control features.

## üìû Support

For issues, questions, or contributions, please open an issue on the [GitHub repository](https://github.com/Rajkumarceo/purple-2.0/issues).

---

**Made with ‚ù§Ô∏è by Rajkumar**

*Purple 2.0 - Your Personal AI Assistant*

